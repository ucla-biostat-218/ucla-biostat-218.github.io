<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.32">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Marc A Suchard @ UCLA">

<title>OMOP CDM and Standardized Vocabularies</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-b6e6edf6cb1293d7f667c2f39c143ab5.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-4d7efdad13f00c6c270b530d954266f4.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="floating quarto-light">

<div id="quarto-search-results"></div>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction"><span class="header-section-number">1</span> Introduction</a></li>
  <li><a href="#data-models-are-everywhere" id="toc-data-models-are-everywhere" class="nav-link" data-scroll-target="#data-models-are-everywhere"><span class="header-section-number">2</span> Data models are everywhere</a></li>
  <li><a href="#what-makes-a-model-standard" id="toc-what-makes-a-model-standard" class="nav-link" data-scroll-target="#what-makes-a-model-standard"><span class="header-section-number">3</span> What makes a model standard?</a></li>
  <li><a href="#what-makes-a-model-standard-1" id="toc-what-makes-a-model-standard-1" class="nav-link" data-scroll-target="#what-makes-a-model-standard-1"><span class="header-section-number">4</span> What makes a model standard?</a></li>
  <li><a href="#examples-of-data-models-in-healthcare" id="toc-examples-of-data-models-in-healthcare" class="nav-link" data-scroll-target="#examples-of-data-models-in-healthcare"><span class="header-section-number">5</span> Examples of data models in healthcare</a></li>
  <li><a href="#added-value-of-standard-data-models" id="toc-added-value-of-standard-data-models" class="nav-link" data-scroll-target="#added-value-of-standard-data-models"><span class="header-section-number">6</span> Added value of standard data models</a></li>
  <li><a href="#standard-data-models-provide-interoperability" id="toc-standard-data-models-provide-interoperability" class="nav-link" data-scroll-target="#standard-data-models-provide-interoperability"><span class="header-section-number">7</span> Standard data models provide interoperability</a></li>
  <li><a href="#formal-logic-in-knowledge-representation" id="toc-formal-logic-in-knowledge-representation" class="nav-link" data-scroll-target="#formal-logic-in-knowledge-representation"><span class="header-section-number">8</span> Formal logic in knowledge representation</a></li>
  <li><a href="#real-world-data-are-closed-world" id="toc-real-world-data-are-closed-world" class="nav-link" data-scroll-target="#real-world-data-are-closed-world"><span class="header-section-number">9</span> Real-world data are closed-world</a></li>
  <li><a href="#why-an-omop-standard-common-data-model" id="toc-why-an-omop-standard-common-data-model" class="nav-link" data-scroll-target="#why-an-omop-standard-common-data-model"><span class="header-section-number">10</span> Why an OMOP standard / common data model?</a></li>
  <li><a href="#omop-cdm" id="toc-omop-cdm" class="nav-link" data-scroll-target="#omop-cdm"><span class="header-section-number">11</span> OMOP CDM</a></li>
  <li><a href="#tables" id="toc-tables" class="nav-link" data-scroll-target="#tables"><span class="header-section-number">12</span> Tables</a></li>
  <li><a href="#tables-1" id="toc-tables-1" class="nav-link" data-scroll-target="#tables-1"><span class="header-section-number">13</span> Tables</a></li>
  <li><a href="#tables-2" id="toc-tables-2" class="nav-link" data-scroll-target="#tables-2"><span class="header-section-number">14</span> Tables</a></li>
  <li><a href="#tables-3" id="toc-tables-3" class="nav-link" data-scroll-target="#tables-3"><span class="header-section-number">15</span> Tables</a></li>
  <li><a href="#simple-data-model" id="toc-simple-data-model" class="nav-link" data-scroll-target="#simple-data-model"><span class="header-section-number">16</span> Simple data model</a></li>
  <li><a href="#schemas-and-data-tables" id="toc-schemas-and-data-tables" class="nav-link" data-scroll-target="#schemas-and-data-tables"><span class="header-section-number">17</span> Schemas and data tables</a></li>
  <li><a href="#events-of-different-nature-organize-into-domains" id="toc-events-of-different-nature-organize-into-domains" class="nav-link" data-scroll-target="#events-of-different-nature-organize-into-domains"><span class="header-section-number">18</span> Events of different nature organize into domains</a></li>
  <li><a href="#semantic-representation-through-concepts" id="toc-semantic-representation-through-concepts" class="nav-link" data-scroll-target="#semantic-representation-through-concepts"><span class="header-section-number">19</span> Semantic representation through concepts</a></li>
  <li><a href="#normalization-in-pictures" id="toc-normalization-in-pictures" class="nav-link" data-scroll-target="#normalization-in-pictures"><span class="header-section-number">20</span> Normalization in pictures</a></li>
  <li><a href="#field-name-conventions" id="toc-field-name-conventions" class="nav-link" data-scroll-target="#field-name-conventions"><span class="header-section-number">21</span> Field name conventions</a></li>
  <li><a href="#explore-the-cdm" id="toc-explore-the-cdm" class="nav-link" data-scroll-target="#explore-the-cdm"><span class="header-section-number">22</span> Explore the CDM</a></li>
  <li><a href="#database-constraints" id="toc-database-constraints" class="nav-link" data-scroll-target="#database-constraints"><span class="header-section-number">23</span> Database constraints</a></li>
  <li><a href="#omop-cdm-1" id="toc-omop-cdm-1" class="nav-link" data-scroll-target="#omop-cdm-1"><span class="header-section-number">24</span> OMOP CDM</a></li>
  <li><a href="#conventions" id="toc-conventions" class="nav-link" data-scroll-target="#conventions"><span class="header-section-number">25</span> Conventions</a></li>
  <li><a href="#technical-conventions" id="toc-technical-conventions" class="nav-link" data-scroll-target="#technical-conventions"><span class="header-section-number">26</span> Technical conventions</a></li>
  <li><a href="#table-specific-conventions" id="toc-table-specific-conventions" class="nav-link" data-scroll-target="#table-specific-conventions"><span class="header-section-number">27</span> Table-specific conventions</a></li>
  <li><a href="#source-data-specific-conventions" id="toc-source-data-specific-conventions" class="nav-link" data-scroll-target="#source-data-specific-conventions"><span class="header-section-number">28</span> Source data-specific conventions</a></li>
  <li><a href="#omop-cdm-2" id="toc-omop-cdm-2" class="nav-link" data-scroll-target="#omop-cdm-2"><span class="header-section-number">29</span> OMOP CDM</a></li>
  <li><a href="#vocabularies" id="toc-vocabularies" class="nav-link" data-scroll-target="#vocabularies"><span class="header-section-number">30</span> Vocabularies</a></li>
  <li><a href="#why-do-we-need-standard-concepts" id="toc-why-do-we-need-standard-concepts" class="nav-link" data-scroll-target="#why-do-we-need-standard-concepts"><span class="header-section-number">31</span> Why do we need standard concepts?</a></li>
  <li><a href="#omop-standardized-vocabularies" id="toc-omop-standardized-vocabularies" class="nav-link" data-scroll-target="#omop-standardized-vocabularies"><span class="header-section-number">32</span> OMOP standardized vocabularies</a></li>
  <li><a href="#example-concept" id="toc-example-concept" class="nav-link" data-scroll-target="#example-concept"><span class="header-section-number">33</span> Example concept</a></li>
  <li><a href="#vocabularies-relate-ideas-concepts" id="toc-vocabularies-relate-ideas-concepts" class="nav-link" data-scroll-target="#vocabularies-relate-ideas-concepts"><span class="header-section-number">34</span> Vocabularies relate ideas (concepts)</a></li>
  <li><a href="#mapping-to-omop-standardized-vocabularies" id="toc-mapping-to-omop-standardized-vocabularies" class="nav-link" data-scroll-target="#mapping-to-omop-standardized-vocabularies"><span class="header-section-number">35</span> Mapping to OMOP standardized vocabularies</a></li>
  <li><a href="#how-many-concepts-are-in-the-ohdsi-standard-vocabularies" id="toc-how-many-concepts-are-in-the-ohdsi-standard-vocabularies" class="nav-link" data-scroll-target="#how-many-concepts-are-in-the-ohdsi-standard-vocabularies"><span class="header-section-number">36</span> How many concepts are in the OHDSI standard vocabularies?</a></li>
  <li><a href="#to-1-semantic-relationships" id="toc-to-1-semantic-relationships" class="nav-link" data-scroll-target="#to-1-semantic-relationships"><span class="header-section-number">37</span> 1-to-1 semantic relationships</a></li>
  <li><a href="#to-n-relationships" id="toc-to-n-relationships" class="nav-link" data-scroll-target="#to-n-relationships"><span class="header-section-number">38</span> 1-to-N relationships</a></li>
  <li><a href="#omop-standardized-vocabularies-in-a-nutshell" id="toc-omop-standardized-vocabularies-in-a-nutshell" class="nav-link" data-scroll-target="#omop-standardized-vocabularies-in-a-nutshell"><span class="header-section-number">39</span> OMOP standardized vocabularies in a nutshell</a></li>
  <li><a href="#extended-cdm-example-endometriosis" id="toc-extended-cdm-example-endometriosis" class="nav-link" data-scroll-target="#extended-cdm-example-endometriosis"><span class="header-section-number">40</span> Extended CDM example: endometriosis</a></li>
  <li><a href="#vocabulary-exercises" id="toc-vocabulary-exercises" class="nav-link" data-scroll-target="#vocabulary-exercises"><span class="header-section-number">41</span> Vocabulary exercises</a></li>
  <li><a href="#vocabulary-exercises-with-solutions" id="toc-vocabulary-exercises-with-solutions" class="nav-link" data-scroll-target="#vocabulary-exercises-with-solutions"><span class="header-section-number">42</span> Vocabulary exercises (with solutions)</a></li>
  <li><a href="#some-more-exercises" id="toc-some-more-exercises" class="nav-link" data-scroll-target="#some-more-exercises"><span class="header-section-number">43</span> Some more exercises</a></li>
  <li><a href="#comparison-of-cdms" id="toc-comparison-of-cdms" class="nav-link" data-scroll-target="#comparison-of-cdms"><span class="header-section-number">44</span> Comparison of CDMs</a></li>
  <li><a href="#extract-transform-load" id="toc-extract-transform-load" class="nav-link" data-scroll-target="#extract-transform-load"><span class="header-section-number">45</span> Extract-transform-load</a></li>
  </ul>
<div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="01_cdm.revealjs.html"><i class="bi bi-file-slides"></i>RevealJS</a></li></ul></div></nav>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar zindex-bottom">
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">OMOP CDM and Standardized Vocabularies</h1>
<p class="subtitle lead">Biostat 218</p>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Marc A Suchard @ UCLA </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<section id="introduction" class="level2" data-number="1">
<h2 data-number="1" class="anchored" data-anchor-id="introduction"><span class="header-section-number">1</span> Introduction</h2>
<p>In these lectures we will learn:</p>
<ul>
<li><p>What are standard / common data models?</p></li>
<li><p>Why an OMOP CDM?</p></li>
<li><p>How is the OMOP CDM normalized?</p></li>
<li><p>About using standardized vocabularies</p></li>
<li><p>How to get observations into standard models</p></li>
</ul>
</section>
<section id="data-models-are-everywhere" class="level2" data-number="2">
<h2 data-number="2" class="anchored" data-anchor-id="data-models-are-everywhere"><span class="header-section-number">2</span> Data models are everywhere</h2>
<p><span class="math inline">\(\ldots\)</span> but mostly implicit</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(speed <span class="sc">~</span> dist, <span class="at">data =</span> cars) <span class="co"># regress y | X</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="co"># speed (y): vector; dist (X): dense matrix </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="quarto-layout-panel" data-layout="[50,50]">
<div class="quarto-layout-row">
<div id="first-column" class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<p><strong>Purpose</strong></p>
<ul>
<li><p>To build software</p></li>
<li><p>To share data</p></li>
</ul>
</div>
<div id="second-column" class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<p><strong>Attributes</strong></p>
<ul>
<li><p>Relational models</p></li>
<li><p>Normalized models</p></li>
<li><p>Closed-world models</p></li>
</ul>
</div>
</div>
</div>
</section>
<section id="what-makes-a-model-standard" class="level2" data-number="3">
<h2 data-number="3" class="anchored" data-anchor-id="what-makes-a-model-standard"><span class="header-section-number">3</span> What makes a model standard?</h2>
<div class="quarto-layout-panel" data-layout="[ 50, 50 ]">
<div class="quarto-layout-row">
<div id="first-column" class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<p><strong>Data models</strong></p>
<ul>
<li><p>Software controls the data</p></li>
<li><p>Value of software <span class="math inline">\(\gg\)</span> data</p></li>
<li><p>Data come to the software</p></li>
</ul>
</div>
<div id="second-column" class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<p><strong>Standard data models</strong></p>
<ul>
<li><p>Data are independent</p></li>
<li><p>Value of data <span class="math inline">\(\gg\)</span> software</p></li>
<li><p>Software comes to the data</p></li>
</ul>
</div>
</div>
</div>
</section>
<section id="what-makes-a-model-standard-1" class="level2" data-number="4">
<h2 data-number="4" class="anchored" data-anchor-id="what-makes-a-model-standard-1"><span class="header-section-number">4</span> What makes a model standard?</h2>
<div class="quarto-layout-panel" data-layout="[ 50, 50 ]">
<div class="quarto-layout-row">
<div id="first-column" class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<p><strong>Data models</strong></p>
<ul>
<li><p>Specific business process</p></li>
<li><p>Implicit in application</p></li>
<li><p>No name</p></li>
<li><p>Not or internally documented</p></li>
<li><p>Support as part of application</p></li>
<li><p>One stakeholder: vendor</p></li>
</ul>
</div>
<div id="second-column" class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<p><strong>Standard data models</strong></p>
<ul>
<li><p>Broad set of use cases</p></li>
<li><p>Explicit, independent of one application</p></li>
<li><p>Branded</p></li>
<li><p>Thoroughly documented</p></li>
<li><p>Independently supported</p></li>
<li><p>Many stakeholders</p></li>
</ul>
</div>
</div>
</div>
</section>
<section id="examples-of-data-models-in-healthcare" class="level2 scrollable" data-number="5">
<h2 class="scrollable anchored" data-number="5" data-anchor-id="examples-of-data-models-in-healthcare"><span class="header-section-number">5</span> Examples of data models in healthcare</h2>
<!-- ::: columns -->
<!-- ::: {.column width="70%"} -->
<!-- ![](images/image_1.jpg) -->
<!-- ::: -->
<!-- ::: {.column width="30%"} -->
<!-- ![](images/image_2.jpg) -->
<!-- ![](images/image_3.jpg) -->
<!-- ::: -->
<!-- ::: -->
<div class="quarto-layout-panel" data-layout="[ 50, 50 ]">
<div class="quarto-layout-row">
<div id="first-column" class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><strong>Data models</strong></p>
<!-- ![](figures/example_data_models.png){.r-stretch} -->
<p><img src="figures/example_data_models.png" class="img-fluid"></p>
</div>
<div id="second-column" class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><strong>Standard data models</strong></p>
<p><img src="figures/example_standard_data_models.png" class="img-fluid"></p>
<ul>
<li>only one is global, and a super-set of several others</li>
</ul>
</div>
</div>
</div>
</section>
<section id="added-value-of-standard-data-models" class="level2" data-number="6">
<h2 data-number="6" class="anchored" data-anchor-id="added-value-of-standard-data-models"><span class="header-section-number">6</span> Added value of standard data models</h2>
<div class="quarto-layout-panel" data-layout="[ 50, 50 ]">
<div class="quarto-layout-row">
<div id="first-column" class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<p><strong>Data models</strong></p>
<ul>
<li><p>Objects</p></li>
<li><p>Relationship</p></li>
</ul>
</div>
<div id="second-column" class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<p><strong>Standard data models</strong></p>
<ul>
<li><p>Objects</p></li>
<li><p>Relationship</p></li>
<li><p>Context</p></li>
<li><p>Conventions</p></li>
<li><p>Training</p></li>
<li><p>Test cases</p></li>
</ul>
</div>
</div>
</div>
</section>
<section id="standard-data-models-provide-interoperability" class="level2" data-number="7">
<h2 data-number="7" class="anchored" data-anchor-id="standard-data-models-provide-interoperability"><span class="header-section-number">7</span> Standard data models provide interoperability</h2>
<p><img src="figures/interoperability.png" class="img-fluid"></p>
</section>
<section id="formal-logic-in-knowledge-representation" class="level2" data-number="8">
<h2 data-number="8" class="anchored" data-anchor-id="formal-logic-in-knowledge-representation"><span class="header-section-number">8</span> Formal logic in knowledge representation</h2>
<div class="quarto-layout-panel" data-layout="[ 50, 50 ]">
<div class="quarto-layout-row">
<div id="first-column" class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<p><strong>Open-world assumption</strong></p>
<ul>
<li><p>What we know <span class="math inline">\(\ldots\)</span> is true</p></li>
<li><p>What we don’t know <span class="math inline">\(\ldots\)</span> we don’t know</p></li>
</ul>
</div>
<div id="second-column" class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<p><strong>Closed-world assumption</strong></p>
<ul>
<li><p>What we know <span class="math inline">\(\ldots\)</span> is true</p></li>
<li><p>What we don’t know <span class="math inline">\(\ldots\)</span> is <em>false</em></p></li>
</ul>
</div>
</div>
</div>
<blockquote class="blockquote">
<p>What does it mean “what we don’t know?”</p>
</blockquote>
</section>
<section id="real-world-data-are-closed-world" class="level2 smaller" data-number="9">
<h2 class="smaller anchored" data-number="9" data-anchor-id="real-world-data-are-closed-world"><span class="header-section-number">9</span> Real-world data are closed-world</h2>
<p>For any given day:</p>
<ol type="1">
<li>If we see a record of something, it happened</li>
<li>If we don’t see a record of something, it did not happen</li>
</ol>
<p>which imples</p>
<ul>
<li>We must know everything that could happen for (2) to hold</li>
<li>Everything we want to record must be in a reference table:
<ul>
<li>all drugs, conditions, procedures, devices, visits, etc</li>
</ul></li>
</ul>
<blockquote class="blockquote">
<p>Only the closed-world assumption allows analytics</p>
<ul>
<li><p>Incidence (how many patients get a disease in a time-period over all patients)</p></li>
<li><p>Prevalence (how many patients have a disease at a time-point over all patients)</p></li>
<li><p>All prediction / epidemiological methods</p></li>
</ul>
</blockquote>
</section>
<section id="why-an-omop-standard-common-data-model" class="level2" data-number="10">
<h2 data-number="10" class="anchored" data-anchor-id="why-an-omop-standard-common-data-model"><span class="header-section-number">10</span> Why an OMOP standard / common data model?</h2>
<div class="quarto-layout-panel" data-layout="[ 50, 50 ]">
<div class="quarto-layout-row">
<div id="first-column" class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="figures/citations.png" class="img-fluid"></p>
<p><br></p>
<p>Over 700 total papers using the OMOP CDM !</p>
<p><a href="https://dash.ohdsi.org/research" class="uri">https://dash.ohdsi.org/research</a></p>
</div>
<div id="second-column" class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="figures/recent_papers.png" class="img-fluid"></p>
</div>
</div>
</div>
</section>
<section id="omop-cdm" class="level2" data-number="11">
<h2 data-number="11" class="anchored" data-anchor-id="omop-cdm"><span class="header-section-number">11</span> OMOP CDM</h2>
<p>The OMOP CDM is a system of</p>
<ul>
<li><strong>tables</strong></li>
<li>conventions, and</li>
<li>vocabularies</li>
</ul>
<p>that allow observational health data to be standardized.</p>
<p>It is this standard approach that facilitaties rapid innovation in the areas of open-source development, methods research and evidence generation.</p>
<p><a href="https://ohdsi.github.io/CommonDataModel/index.html" class="uri">https://ohdsi.github.io/CommonDataModel/index.html</a></p>
</section>
<section id="tables" class="level2" data-number="12">
<h2 data-number="12" class="anchored" data-anchor-id="tables"><span class="header-section-number">12</span> Tables</h2>
<p>The OMOP CDM is a <strong>person-centric</strong> model</p>
<p><img src="figures/person_centric.png" class="img-fluid" style="width:50.0%"></p>
</section>
<section id="tables-1" class="level2" data-number="13">
<h2 data-number="13" class="anchored" data-anchor-id="tables-1"><span class="header-section-number">13</span> Tables</h2>
<p>A typical patient journey within a healthcare system</p>
<p><img src="figures/healthcare_journey.png" class="img-fluid"></p>
</section>
<section id="tables-2" class="level2" data-number="14">
<h2 data-number="14" class="anchored" data-anchor-id="tables-2"><span class="header-section-number">14</span> Tables</h2>
<p>A typical patient journey within a healthcare system <strong>into data</strong></p>
<p><img src="figures/healthcare_journey_data.png" class="img-fluid"></p>
</section>
<section id="tables-3" class="level2 scrollable" data-number="15">
<h2 class="scrollable anchored" data-number="15" data-anchor-id="tables-3"><span class="header-section-number">15</span> Tables</h2>
<p>A typical patient journey within a healthcare system <strong>into data</strong></p>
<div class="column" style="width:100%;">
<p><img src="figures/cdm_person.png" class="img-fluid"></p>
</div>
<p>All clinical event tables are linked to the <code>PERSON</code> table. Adding the date or start-date to events allows for a longitudinal view on all relevant events by person.</p>
<ul>
<li>Exception: standardized health system data tables</li>
</ul>
</section>
<section id="simple-data-model" class="level2" data-number="16">
<h2 data-number="16" class="anchored" data-anchor-id="simple-data-model"><span class="header-section-number">16</span> Simple data model</h2>
<p><img src="figures/simple_data_model.png" class="img-fluid"></p>
</section>
<section id="schemas-and-data-tables" class="level2 scrollable" data-number="17">
<h2 class="scrollable anchored" data-number="17" data-anchor-id="schemas-and-data-tables"><span class="header-section-number">17</span> Schemas and data tables</h2>
<p>Database schema separate between read-only and read-write tables</p>
<ul>
<li><p>CDM</p>
<ul>
<li>Clinical event tables</li>
<li>Vocabulary tables</li>
</ul></li>
<li><p>Results</p>
<ul>
<li><code>COHORT</code> (basis of analysis)</li>
<li><code>COHORT_DEFINITION</code></li>
</ul></li>
</ul>
<p>The CDM is platform-independent. Data types are basic ANSI SQL</p>
<ul>
<li><code>VARCHAR</code>, <code>BIGINT</code>, <code>INTEGER</code>, <code>FLOAT</code>, <code>DATE</code>, <code>DATETIME</code>, <code>CLOB</code></li>
</ul>
</section>
<section id="events-of-different-nature-organize-into-domains" class="level2" data-number="18">
<h2 data-number="18" class="anchored" data-anchor-id="events-of-different-nature-organize-into-domains"><span class="header-section-number">18</span> Events of different nature organize into domains</h2>
<p>Events are stored in <code>domain-specific</code> tables and represented by <code>standard concepts</code></p>
<ul>
<li>Condition domain
<ul>
<li>signs, symptoms, diagnoses</li>
<li><code>CONDITION_OCCURRENCE</code> table</li>
</ul></li>
<li>Drug domain
<ul>
<li><code>DRUG_EXPOSURE</code> table</li>
</ul></li>
</ul>
</section>
<section id="semantic-representation-through-concepts" class="level2 scrollable" data-number="19">
<h2 class="scrollable anchored" data-number="19" data-anchor-id="semantic-representation-through-concepts"><span class="header-section-number">19</span> Semantic representation through concepts</h2>
<p>Each record is fully <strong>normalized</strong> through concepts</p>
<ul>
<li>Unique <code>CONCEPT_ID</code> values (foreign keys to <code>CONCEPT</code> table)</li>
</ul>
<p>All CDM instances use the <em>same</em> <code>CONCEPT</code> table as a reference</p>
<ul>
<li>Chief mechanism of interoperability</li>
</ul>
<p>If a standard concept does not exist (or cannot be identified) <code>CONCEPT_ID</code> = 0</p>
</section>
<section id="normalization-in-pictures" class="level2" data-number="20">
<h2 data-number="20" class="anchored" data-anchor-id="normalization-in-pictures"><span class="header-section-number">20</span> Normalization in pictures</h2>
<p><img src="figures/normalization_keys.png" class="img-fluid" style="width:100.0%"></p>
<ul>
<li>Importance becomes (even more) obvious across data sources (language, coding systems)</li>
</ul>
</section>
<section id="field-name-conventions" class="level2 scrollable smaller" data-number="21">
<h2 class="scrollable smaller anchored" data-number="21" data-anchor-id="field-name-conventions"><span class="header-section-number">21</span> Field name conventions</h2>
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: left;">Notation</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">[Event]_ID</td>
<td style="text-align: left;">Unique identifier for each record, which serves as a foreign keys establishing relationships across Event tables. For example, PERSON_ID uniquely identifies each individual. VISIT_OCCURRENCE_ID uniquely identifies a Visit.</td>
</tr>
<tr class="even">
<td style="text-align: left;">[Event]_CONCEPT_ID</td>
<td style="text-align: left;">Foreign key to a Standard Concept record in the CONCEPT reference table. This is the main representation of the Event, serving as the primary basis for all standardized analytics. For example, CONDITION_CONCEPT_ID = <a href="http://athena.ohdsi.org/search-terms/terms/31967">31967</a> contains the reference value for the SNOMED concept of “Nausea”.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">[Event]_SOURCE _CONCEPT_ID</td>
<td style="text-align: left;">Foreign key to a record in the CONCEPT reference table. This Concept is the equivalent of the Source Value (below), and it may happen to be a Standard Concept, at which point it would be identical to the [Event]_CONCEPT_ID, or another non-standard concept. For example, CONDITION_SOURCE_CONCEPT_ID = <a href="http://athena.ohdsi.org/search-terms/terms/45431665">45431665</a> denotes the concept of “Nausea” in the Read terminology, and the analogous CONDITION_CONCEPT_ID is the Standard SNOMED-CT Concept <a href="http://athena.ohdsi.org/search-terms/terms/31967">31967</a>. The use of Source Concepts for standard analytics applications is discouraged since only Standard Concepts represent the semantic content of an Event in a unambiguous way and therefore Source Concepts are not interoperable.</td>
</tr>
<tr class="even">
<td style="text-align: left;">[Event]_TYPE_CONCEPT_ID</td>
<td style="text-align: left;">Foreign key to a record in the CONCEPT reference table, representing the origin of the source information, standardized within the Standardized Vocabularies. Note that despite the field name this is not a type of an Event, or type of a Concept, but declares the capture mechanism that created this record. For example, DRUG_TYPE_CONCEPT_ID discriminates if a Drug record was derived from a dispensing Event in the pharmacy (“Pharmacy dispensing”) or from an e-prescribing application (“Prescription written”)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">[Event]_SOURCE_VALUE</td>
<td style="text-align: left;">Verbatim code or free text string reflecting how this Event was represented in the source data. Its use is discouraged for standard analytics applications, as these Source Values are not harmonized across data sources. For example, CONDITION_SOURCE_VALUE might contain a record of “78702”, corresponding to ICD-9 code 787.02 written in a notation omitting the dot.</td>
</tr>
</tbody>
</table>
</section>
<section id="explore-the-cdm" class="level2" data-number="22">
<h2 data-number="22" class="anchored" data-anchor-id="explore-the-cdm"><span class="header-section-number">22</span> Explore the CDM</h2>
<ul>
<li><p><a href="https://ohdsi.github.io/CommonDataModel/cdm54.html">OMOP CDM v5.4 schema</a> (link)</p></li>
<li><p><a href="https://github.com/OHDSI/CommonDataModel/blob/v5.4.0/inst/ddl/5.4/sql_server/OMOPCDM_sql_server_5.4_ddl.sql">OMOP CDM v5.4 DDL</a> (link)</p></li>
</ul>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Data definition language (DDL)
</div>
</div>
<div class="callout-body-container callout-body">

</div>
</div>
<!-- ## Normalization -->
<!-- Defining "keys" (`concept_id`) and populating reference tables -->
<!-- ![](figures/normalization_keys.png) -->
</section>
<section id="database-constraints" class="level2" data-number="23">
<h2 data-number="23" class="anchored" data-anchor-id="database-constraints"><span class="header-section-number">23</span> Database constraints</h2>
<ul>
<li><p><code>NOT NULL</code>: must have a value</p></li>
<li><p><code>UNIQUE KEY</code>: value must only exist once in table</p></li>
<li><p><code>PRIMARY KEY</code>: <code>NOT NULL</code> + <code>UNIQUE KEY</code></p></li>
<li><p><code>FOREIGN KEY</code>: must have a value in a parent table / field</p></li>
<li><p><code>CHECK</code>: must check out (e.g.&nbsp;is positive)</p></li>
</ul>
<p><a href="https://github.com/OHDSI/CommonDataModel/blob/v5.4.0/inst/ddl/5.4/sql_server/OMOPCDM_sql_server_5.4_constraints.sql">OMOP CDM v5.4 constraints</a> (link)</p>
</section>
<section id="omop-cdm-1" class="level2" data-number="24">
<h2 data-number="24" class="anchored" data-anchor-id="omop-cdm-1"><span class="header-section-number">24</span> OMOP CDM</h2>
<p>The OMOP CDM is a system of</p>
<ul>
<li>tables</li>
<li><strong>conventions</strong>, and</li>
<li>vocabularies</li>
</ul>
<p>that allow observational health data to be standardized.</p>
<p>It is this standard approach that facilitaties rapid innovation in the areas of open-source development, methods research and evidence generation.</p>
<p><a href="https://ohdsi.github.io/CommonDataModel/index.html" class="uri">https://ohdsi.github.io/CommonDataModel/index.html</a></p>
</section>
<section id="conventions" class="level2" data-number="25">
<h2 data-number="25" class="anchored" data-anchor-id="conventions"><span class="header-section-number">25</span> Conventions</h2>
<p><img src="figures/conventions.png" class="img-fluid"></p>
</section>
<section id="technical-conventions" class="level2" data-number="26">
<h2 data-number="26" class="anchored" data-anchor-id="technical-conventions"><span class="header-section-number">26</span> Technical conventions</h2>
<p><img src="figures/fields.png" class="img-fluid"></p>
<p><a href="https://ohdsi.github.io/CommonDataModel/dataModelConventions.html">OMOP CDM v5.4 conventions</a> (link)</p>
</section>
<section id="table-specific-conventions" class="level2" data-number="27">
<h2 data-number="27" class="anchored" data-anchor-id="table-specific-conventions"><span class="header-section-number">27</span> Table-specific conventions</h2>
<p><img src="figures/person_conventions.png" class="img-fluid"></p>
</section>
<section id="source-data-specific-conventions" class="level2" data-number="28">
<h2 data-number="28" class="anchored" data-anchor-id="source-data-specific-conventions"><span class="header-section-number">28</span> Source data-specific conventions</h2>
<p><img src="figures/source_conventions.png" class="img-fluid"></p>
</section>
<section id="omop-cdm-2" class="level2" data-number="29">
<h2 data-number="29" class="anchored" data-anchor-id="omop-cdm-2"><span class="header-section-number">29</span> OMOP CDM</h2>
<p>The OMOP CDM is a system of</p>
<ul>
<li>tables</li>
<li>conventions, and</li>
<li><strong>vocabularies</strong></li>
</ul>
<p>that allow observational health data to be standardized.</p>
<p>It is this standard approach that facilitaties rapid innovation in the areas of open-source development, methods research and evidence generation.</p>
<p><a href="https://ohdsi.github.io/CommonDataModel/index.html" class="uri">https://ohdsi.github.io/CommonDataModel/index.html</a></p>
</section>
<section id="vocabularies" class="level2" data-number="30">
<h2 data-number="30" class="anchored" data-anchor-id="vocabularies"><span class="header-section-number">30</span> Vocabularies</h2>
<p><img src="figures/cdm_voc.png" class="img-fluid"></p>
</section>
<section id="why-do-we-need-standard-concepts" class="level2" data-number="31">
<h2 data-number="31" class="anchored" data-anchor-id="why-do-we-need-standard-concepts"><span class="header-section-number">31</span> Why do we need standard concepts?</h2>
<p><img src="figures/bladder_cancer_vocab.png" class="img-fluid"></p>
</section>
<section id="omop-standardized-vocabularies" class="level2" data-number="32">
<h2 data-number="32" class="anchored" data-anchor-id="omop-standardized-vocabularies"><span class="header-section-number">32</span> OMOP standardized vocabularies</h2>
<p><img src="figures/vocab_schema.png" class="img-fluid"></p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Example DDL diagram
</div>
</div>
<div class="callout-body-container callout-body">

</div>
</div>
</section>
<section id="example-concept" class="level2" data-number="33">
<h2 data-number="33" class="anchored" data-anchor-id="example-concept"><span class="header-section-number">33</span> Example concept</h2>
<p><img src="figures/example_concept.png" class="img-fluid"></p>
</section>
<section id="vocabularies-relate-ideas-concepts" class="level2" data-number="34">
<h2 data-number="34" class="anchored" data-anchor-id="vocabularies-relate-ideas-concepts"><span class="header-section-number">34</span> Vocabularies relate ideas (concepts)</h2>
<p><img src="figures/vocab_relationships.png" class="img-fluid"></p>
<p>A semantic concept is a concept that is represented in a network of interconnected concepts</p>
</section>
<section id="mapping-to-omop-standardized-vocabularies" class="level2 scrollable" data-number="35">
<h2 class="scrollable anchored" data-number="35" data-anchor-id="mapping-to-omop-standardized-vocabularies"><span class="header-section-number">35</span> Mapping to OMOP standardized vocabularies</h2>
<div class="column" style="width:100%;">
<p><img src="figures/source_to_standard.png" class="img-fluid"></p>
</div>
<p>What is standardized:</p>
<ul>
<li><p><code>[TABLE]_CONCEPT_ID</code>: standard concept to which the source code maps, <strong>used for analysis</strong></p></li>
<li><p><code>[TABLE]_SOURCE_CONCEPT_ID</code>: concept representation of the source code, <strong>helps maintain tie to raw data</strong></p></li>
<li><p><code>[TABLE]_SOURCE_VALUE</code>: original source code as given in source table, <strong>helps to review data quality</strong></p></li>
</ul>
<p>Way to map a source code to standard code:</p>
<ul>
<li><code>CONCEPT_RELATIONSHIP</code> table</li>
</ul>
</section>
<section id="how-many-concepts-are-in-the-ohdsi-standard-vocabularies" class="level2 scrollable" data-number="36">
<h2 class="scrollable anchored" data-number="36" data-anchor-id="how-many-concepts-are-in-the-ohdsi-standard-vocabularies"><span class="header-section-number">36</span> How many concepts are in the OHDSI standard vocabularies?</h2>
<div class="columns">
<div class="column" style="width:30%;">
<p><img src="figures/all_vocabularies.png" class="img-fluid" style="width:100.0%"></p>
</div><div class="column" style="width:70%;">
<ul>
<li><p>111 different vocabularies (like ICD-10, RxNorm)</p></li>
<li><p>78 are adopted from external sources (with differing licensing requirements)</p></li>
</ul>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Best ways to interact with the vocabularies
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><a href="https://athena.ohdsi.org">ATHENA</a> (link)</li>
<li><a href="https://atlas-demo.ohdsi.org">ATLAS</a> (link) by building concept sets</li>
</ul>
</div>
</div>
</div>
</div>
</section>
<section id="to-1-semantic-relationships" class="level2" data-number="37">
<h2 data-number="37" class="anchored" data-anchor-id="to-1-semantic-relationships"><span class="header-section-number">37</span> 1-to-1 semantic relationships</h2>
<p><img src="figures/maps_to.png" class="img-fluid"></p>
</section>
<section id="to-n-relationships" class="level2" data-number="38">
<h2 data-number="38" class="anchored" data-anchor-id="to-n-relationships"><span class="header-section-number">38</span> 1-to-N relationships</h2>
<p><img src="figures/1_to_n_mapping.png" class="img-fluid"></p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Mappings can even across multiple domains
</div>
</div>
<div class="callout-body-container callout-body">

</div>
</div>
</section>
<section id="omop-standardized-vocabularies-in-a-nutshell" class="level2 scrollable" data-number="39">
<h2 class="scrollable anchored" data-number="39" data-anchor-id="omop-standardized-vocabularies-in-a-nutshell"><span class="header-section-number">39</span> OMOP standardized vocabularies in a nutshell</h2>
<p>What they are:</p>
<ul>
<li><strong>Standardized structure</strong> to house existing vocabularies used in the public domain</li>
<li><strong>Compiled standards</strong> from disparate public and private sources and some OMOP-grown concepts</li>
</ul>
<p>What they are not:</p>
<ul>
<li><strong>Static dataset</strong>: vocabularies update regularly to keep up with the continuous evolution of the sources</li>
<li><strong>Finished product</strong>: vocabulary maintenance and improvement is an ongoing activity that requires community participation and support</li>
</ul>
</section>
<section id="extended-cdm-example-endometriosis" class="level2" data-number="40">
<h2 data-number="40" class="anchored" data-anchor-id="extended-cdm-example-endometriosis"><span class="header-section-number">40</span> Extended CDM example: endometriosis</h2>
<p>We will walk through the story of Lauren:</p>
<ul>
<li>From the <a href="https://ohdsi.github.io/TheBookOfOhdsi/CommonDataModel.html#running-example-endometriosis">Book of OHDSI</a> (link)</li>
</ul>
</section>
<section id="vocabulary-exercises" class="level2" data-number="41">
<h2 data-number="41" class="anchored" data-anchor-id="vocabulary-exercises"><span class="header-section-number">41</span> Vocabulary exercises</h2>
<p>Using <a href="https://athena.ohdsi.org" class="uri">https://athena.ohdsi.org</a>, find standard concept IDs for the following conditions:</p>
<ul>
<li>Asthma</li>
<li>Plague</li>
<li>Ingrown toenail</li>
</ul>
<p>Final standard concept IDs for the following drug ingredients:</p>
<ul>
<li>Metformin</li>
<li>Tolazamid</li>
<li>Telmisartan</li>
</ul>
</section>
<section id="vocabulary-exercises-with-solutions" class="level2" data-number="42">
<h2 data-number="42" class="anchored" data-anchor-id="vocabulary-exercises-with-solutions"><span class="header-section-number">42</span> Vocabulary exercises (with solutions)</h2>
<p>Using <a href="https://athena.ohdsi.org" class="uri">https://athena.ohdsi.org</a>, find standard concept IDs for the following conditions:</p>
<ul>
<li>Asthma (<code>317009</code>)</li>
<li>Plague (<code>434271</code>)</li>
<li>Ingrown toenail (<code>4065236</code>, <code>4290993</code>)</li>
</ul>
<p>Final standard concept IDs for the following drug ingredients:</p>
<ul>
<li>Metformin (<code>1503297</code>)</li>
<li>Tolazamid (<code>1502809</code>)</li>
<li>Telmisartan (<code>1317640</code>)</li>
</ul>
</section>
<section id="some-more-exercises" class="level2" data-number="43">
<h2 data-number="43" class="anchored" data-anchor-id="some-more-exercises"><span class="header-section-number">43</span> Some more exercises</h2>
<ul>
<li><p>What is the standard concept ID for ICD10 code E11.9?</p></li>
<li><p>What is the standard concept ID for the ICD10 code C78.0?</p></li>
<li><p>What ICD10 codes are mapped to the concept ID 443767?</p></li>
<li><p>What is the standard concept ID for the ICD10 code code X67.0?</p></li>
</ul>
</section>
<section id="comparison-of-cdms" class="level2" data-number="44">
<h2 data-number="44" class="anchored" data-anchor-id="comparison-of-cdms"><span class="header-section-number">44</span> Comparison of CDMs</h2>
<p>Balancing trade-offs in data management vs analysis complexity</p>
<p><img src="figures/trade_off.png" class="img-fluid"></p>
</section>
<section id="extract-transform-load" class="level2 scrollable" data-number="45">
<h2 class="scrollable anchored" data-number="45" data-anchor-id="extract-transform-load"><span class="header-section-number">45</span> Extract-transform-load</h2>
<p><img src="figures/etl_steps.png" class="img-fluid"></p>
<ul>
<li><p><a href="https://ohdsi.github.io/TheBookOfOhdsi/ExtractTransformLoad.html">Book of OHDSI chapter</a> (link)</p></li>
<li><p><a href="https://pubmed.ncbi.nlm.nih.gov/37952118/">Recent paper on OMOP ETL challenges across Europe</a> (link)</p></li>
<li><p><a href="https://github.com/OHDSI/Tutorial-ETL">Full-day tutorial</a> (link)</p></li>
</ul>
<!-- ::: {.absolute left="55%" top="55%" style="font-size:1.8em; padding: 0.5em 1em; background-color: rgba(255, 255, 255, .5); backdrop-filter: blur(5px); box-shadow: 0 0 1rem 0 rgba(0, 0, 0, .5); border-radius: 5px;"} -->
<!-- Be Brave -->
<!-- Take Risks -->
<!-- ::: -->
<!-- https://emilhvitfeldt.com/project/slidecraft-101/#blog-posts -->


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>